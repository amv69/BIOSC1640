{% extends "layout.html" %}
{% block content %}
<div class="content=section">
    <form class="form" method="POST" action="">
    	{{ form.hidden_tag()}}
        <fieldset class="form-group">
            <legend class="border-bottom mb-4">Submit FastA</legend>
            <div class="form-group col-md-12 mb-4">
                {{ form.fastA.label(class_="form-control-label") }}
                {{ form.fastA(class="form-control-file", rows="4") }}
            </div>
            <div class ="row" align="center">
                <div class="form-group col mb-4">
                    {{ form.lengthOne.label(class_="form-control-label") }}
                    {{ form.lengthOne(class="form-control") }}
                    <small class="text-muted">
                        Should not be smaller than X
                    </small>
                </div>
                <div class="form-group col mb-4">
                    {{ form.lengthTwo.label(class_="form-control-label") }}
                    {{ form.lengthTwo(class="form-control") }}
                    <small class="text-muted">
                        Should not be larger than X
                    </small>
                </div>
            </div>
            <div class="row" align="center">
                <div class="form-group col mb-4">
                    {{ form.tempOne.label(class_="form-control-label") }}
                    {{ form.tempOne(class="form-control") }}
                    <small class="text-muted">
                        Should not be smaller than X
                    </small>
                </div>
                <div class="form-group col mb-4">
                    {{ form.tempTwo.label(class_="form-control-label") }}
                    {{ form.tempTwo(class="form-control") }}
                    <small class="text-muted">
                        Should not be larger than X
                    </small>
                </div>
            </div>
            <div class="row" align="center">
                <div class="form-group col mb-4">
                    {{ form.maxTile.label(class_="form-control-label") }}
                    {{ form.maxTile(class="form-control") }}
                    <small class="text-muted">
                        Should not be smaller than X
                    </small>
                </div>
            </div>
        </fieldset>
        <div class="form-group col-md-6">
            {{ form.submit(class="btn btn-outline-info") }}
        </div>
    </form>
    <p>Output:</p><br>

    <textarea class="form-control-file" rows="4" id="textArea">{{ output }} &#10;&#13;{{ output2 }}</textarea>
    <button type="button" value="save" id="save">Save</button>
</div>
{% endblock content %}

<script>
	function saveTextAsFile() {
  var textToWrite = document.getElementById('textArea').innerHTML;
  var textFileAsBlob = new Blob([ textToWrite ], { type: 'text/plain' });
  var fileNameToSaveAs = "ecc.plist";

  var downloadLink = document.createElement("a");
  downloadLink.download = fileNameToSaveAs;
  downloadLink.innerHTML = "Download File";
  if (window.webkitURL != null) {
    // Chrome allows the link to be clicked without actually adding it to the DOM.
    downloadLink.href = window.webkitURL.createObjectURL(textFileAsBlob);
  } else {
    // Firefox requires the link to be added to the DOM before it can be clicked.
    downloadLink.href = window.URL.createObjectURL(textFileAsBlob);
    downloadLink.onclick = destroyClickedElement;
    downloadLink.style.display = "none";
    document.body.appendChild(downloadLink);
  }

  downloadLink.click();
}

var button = document.getElementById('save');
button.addEventListener('click', saveTextAsFile);

function destroyClickedElement(event) {
  // remove the link from the DOM
  document.body.removeChild(event.target);
}
</script>